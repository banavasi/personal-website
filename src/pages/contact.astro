---
import BaseLayout from '../layouts/BaseLayout.astro';
import { SITE_TITLE } from '../consts';
import { Button } from '../components/ui/button';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '../components/ui/card';
import { Input } from '../components/ui/input';
import { Textarea } from '../components/ui/textarea';
---

<BaseLayout title={`Contact | ${SITE_TITLE}`} description="Get in touch with Shashank Shandilya">
	<div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-5xl relative z-10">
		<!-- Page Header -->
		<section class="py-16 sm:py-20 header-section opacity-0 translate-y-10">
			<div class="max-w-3xl mx-auto text-center">
				<h1 class="text-4xl sm:text-5xl lg:text-6xl font-bold mb-4 bg-gradient-to-r from-white via-white/90 to-white/70 bg-clip-text text-transparent">
					Let's Connect
				</h1>
				<p class="text-xl text-gray-400 leading-relaxed">
					Whether you're looking for technical leadership, have a project in mind, or just want to say hello—I'd love to hear from you.
				</p>
			</div>
		</section>

		<!-- Contact Grid -->
		<section class="pb-20">
			<div class="grid lg:grid-cols-2 gap-12">
				<!-- Contact Form -->
				<div class="form-section opacity-0 translate-y-10">
					<Card client:load className="border-white/10 bg-white/5 backdrop-blur-sm">
						<CardHeader>
							<CardTitle className="text-2xl text-white">Send a Message</CardTitle>
							<CardDescription className="text-gray-400">Fill out the form and I'll get back to you as soon as possible</CardDescription>
						</CardHeader>
						<CardContent>
							<form class="space-y-6" id="contact-form">
								<div class="space-y-2">
									<label for="name" class="text-sm font-medium text-gray-300">Name</label>
									<Input client:load id="name" name="name" type="text" placeholder="Your name" required className="bg-black/20 border-white/10 text-white placeholder:text-gray-500" />
								</div>

								<div class="space-y-2">
									<label for="email" class="text-sm font-medium text-gray-300">Email</label>
									<Input client:load id="email" name="email" type="email" placeholder="your.email@example.com" required className="bg-black/20 border-white/10 text-white placeholder:text-gray-500" />
								</div>

								<div class="space-y-2">
									<label for="subject" class="text-sm font-medium text-gray-300">Subject</label>
									<Input client:load id="subject" name="subject" type="text" placeholder="What's this about?" required className="bg-black/20 border-white/10 text-white placeholder:text-gray-500" />
								</div>

								<div class="space-y-2">
									<label for="message" class="text-sm font-medium text-gray-300">Message</label>
									<Textarea client:load id="message" name="message" placeholder="Your message..." rows={6} required className="bg-black/20 border-white/10 text-white placeholder:text-gray-500" />
								</div>

								<Button client:load type="submit" size="lg" className="w-full bg-white text-black hover:bg-gray-200" id="submit-button">
									Send Message
								</Button>
                                <p id="form-status" class="text-center text-sm hidden"></p>
							</form>
						</CardContent>
					</Card>
				</div>

				<!-- Contact Info & Links -->
				<div class="space-y-8 info-section opacity-0 translate-y-10">
					<Card client:load className="border-white/10 bg-white/5 backdrop-blur-sm">
						<CardHeader>
							<CardTitle className="text-2xl text-white">Connect Online</CardTitle>
							<CardDescription className="text-gray-400">Find me on these platforms</CardDescription>
						</CardHeader>
						<CardContent className="space-y-4">
							<a
								href="https://www.linkedin.com/in/shashank-shandilya-v"
								target="_blank"
								rel="noopener noreferrer"
								class="flex items-center gap-4 p-4 rounded-lg bg-white/5 hover:bg-white/10 transition-colors group border border-transparent hover:border-white/10"
							>
								<div class="text-2xl group-hover:scale-110 transition-transform text-white">
									<svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24">
										<path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
									</svg>
								</div>
								<div>
									<div class="font-semibold text-white">LinkedIn</div>
									<div class="text-sm text-gray-400">Professional network</div>
								</div>
							</a>

							<a
								href="https://github.com/banavasi"
								target="_blank"
								rel="noopener noreferrer"
								class="flex items-center gap-4 p-4 rounded-lg bg-white/5 hover:bg-white/10 transition-colors group border border-transparent hover:border-white/10"
							>
								<div class="text-2xl group-hover:scale-110 transition-transform text-white">
									<svg class="w-8 h-8" fill="currentColor" viewBox="0 0 16 16">
										<path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
									</svg>
								</div>
								<div>
									<div class="font-semibold text-white">GitHub</div>
									<div class="text-sm text-gray-400">Code & open source</div>
								</div>
							</a>
						</CardContent>
					</Card>

					<Card client:load className="border-white/10 bg-white/5 backdrop-blur-sm">
						<CardHeader>
							<CardTitle className="text-white">Response Time</CardTitle>
						</CardHeader>
						<CardContent>
							<p class="text-gray-400">
								I typically respond to messages within 24-48 hours. For urgent matters, feel free to connect with me on LinkedIn.
							</p>
						</CardContent>
					</Card>

					<Card client:load className="border-white/10 bg-white/5 backdrop-blur-sm">
						<CardHeader>
							<CardTitle className="text-white">Collaboration</CardTitle>
						</CardHeader>
						<CardContent>
							<p class="text-gray-400">
								I'm always interested in discussing new opportunities, technical challenges, or potential collaborations. Let's build something amazing together!
							</p>
						</CardContent>
					</Card>
				</div>
			</div>
		</section>

		<!-- Navigation -->
		<section class="py-12 border-t border-white/10 nav-section opacity-0 translate-y-10">
			<div class="flex justify-between items-center flex-wrap gap-4">
				<a href="/education" class="text-gray-400 hover:text-white transition-colors flex items-center gap-2 group">
					<span class="group-hover:-translate-x-1 transition-transform">←</span>
					<span>Education</span>
				</a>
				<a href="/" class="text-gray-400 hover:text-white transition-colors flex items-center gap-2 group">
					<span>Home</span>
					<span class="group-hover:translate-x-1 transition-transform">→</span>
				</a>
			</div>
		</section>
	</div>
</BaseLayout>

<script>
	import gsap from 'gsap';
	import { ScrollTrigger } from 'gsap/ScrollTrigger';

	gsap.registerPlugin(ScrollTrigger);

	// Header Animation
	gsap.to('.header-section', {
		opacity: 1,
		y: 0,
		duration: 1,
		ease: 'power3.out',
		delay: 0.2
	});

	// Form Section
	gsap.to('.form-section', {
		opacity: 1,
		y: 0,
		duration: 1,
		ease: 'power3.out',
		delay: 0.4
	});

	// Info Section
	gsap.to('.info-section', {
		opacity: 1,
		y: 0,
		duration: 1,
		ease: 'power3.out',
		delay: 0.6
	});

	// Nav Section
	gsap.to('.nav-section', {
		scrollTrigger: {
			trigger: '.nav-section',
			start: 'top 95%',
			toggleActions: 'play none none reverse'
		},
		opacity: 1,
		y: 0,
		duration: 1,
		ease: 'power3.out'
	});
	// Form Submission
	const form = document.getElementById('contact-form') as HTMLFormElement;
	const submitButton = document.getElementById('submit-button') as HTMLButtonElement;
	const statusMessage = document.getElementById('form-status') as HTMLParagraphElement;

	if (form) {
		form.addEventListener('submit', async (e) => {
			e.preventDefault();
			
			// Disable button and show loading state
			if (submitButton) {
				submitButton.disabled = true;
				submitButton.textContent = 'Sending...';
			}
			
			if (statusMessage) {
				statusMessage.classList.add('hidden');
				statusMessage.classList.remove('text-green-400', 'text-red-400');
			}

			const formData = new FormData(form);
			formData.append('url', window.location.href);

			try {
				const response = await fetch('/api/contact', {
					method: 'POST',
					body: formData,
				});

				const result = await response.json() as { message: string };

				if (response.ok) {
					if (statusMessage) {
						statusMessage.textContent = 'Message sent successfully!';
						statusMessage.classList.remove('hidden');
						statusMessage.classList.add('text-green-400');
					}
					form.reset();
				} else {
					throw new Error(result.message || 'Failed to send message');
				}
			} catch (error) {
				console.error('Error:', error);
				if (statusMessage) {
					statusMessage.textContent = error instanceof Error ? error.message : 'Something went wrong. Please try again.';
					statusMessage.classList.remove('hidden');
					statusMessage.classList.add('text-red-400');
				}
			} finally {
				// Re-enable button
				if (submitButton) {
					submitButton.disabled = false;
					submitButton.textContent = 'Send Message';
				}
			}
		});
	}
</script>
